<% if !project.is_shipped %>
  <% creation_locked = Flipper.enabled?(:ship_locked, current_user) %>
  <% if policy(project).can_see_certification_details? && project.latest_ship_certification&.rejected? %>
    <%= render C::StyledButton.new(
        text: "Ship It!",
        kind: "primary",
        icon: "ship.svg",
        disabled: creation_locked,
        data: creation_locked ? {} : {
          controller: "modal",
          action: "click->modal#open",
          modal_id: "#{project.id}",
          modal_type: "certification"
        }) %>
  <% else %>
    <% if !Flipper.enabled?(:new_onboarding, current_user) || current_user&.tutorial_progress&.new_tutorial_step_completed?(:ship) %>
      <%= render C::StyledButton.new(
          text: "Ship It!",
          kind: "primary",
          icon: "ship.svg",
          disabled: creation_locked,
          data: creation_locked ? {} : {
            controller: "modal",
            action: "modal#open",
            modal_id: "#{project.id}",
            modal_type: "is_shipped"
          }) %>
    <% else %>
      <%= render C::StyledButton.new(
          text: "Ship It!",
          kind: "primary",
          icon: "ship.svg",
          disabled: creation_locked,
          data: creation_locked ? {} : {
            action: "new-tutorial#startShipScene",
          }) %>
    <% end %>
  <% end %>
<% else %>
  <%= render C::StyledButton.new(
      text: "Shipped!",
      kind: "primary",
      icon: "ship.svg",
      disabled: true) %>
<% end %>
